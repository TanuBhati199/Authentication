<Window
  x:Class="CaseManagementSystem.Views.Authentication.ForgotPasswordView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:vm="clr-namespace:CaseManagementSystem.ViewModels"
  xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
  Background="#F5F5F5"
  Title="Password Recovery"
  Height="650"
  Width="800"
  WindowStartupLocation="CenterScreen"
  WindowStyle="None"
  AllowsTransparency="True"
  ResizeMode="NoResize"
>
  <Window.DataContext>
    <vm:ForgotPasswordViewModel />
  </Window.DataContext>

  <Window.Resources>
    <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />

    <!-- String is not empty converter -->
    <Style x:Key="StatusMessageBorderStyle" TargetType="Border">
      <Setter Property="Visibility" Value="Collapsed" />
      <Style.Triggers>
        <DataTrigger Binding="{Binding StatusMessage}" Value="{x:Null}">
          <Setter Property="Visibility" Value="Collapsed" />
        </DataTrigger>
        <DataTrigger Binding="{Binding StatusMessage}" Value="">
          <Setter Property="Visibility" Value="Collapsed" />
        </DataTrigger>
      </Style.Triggers>
    </Style>
    <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
      <Setter Property="FontSize" Value="13" />
      <Setter Property="FontWeight" Value="SemiBold" />
      <Setter Property="Foreground" Value="#424242" />
      <Setter Property="Margin" Value="0,0,0,8" />
    </Style>

    <Style
      x:Key="PrimaryButtonStyle"
      TargetType="telerik:RadButton"
      BasedOn="{StaticResource {x:Type telerik:RadButton}}"
    >
      <Setter Property="Height" Value="44" />
      <Setter Property="FontSize" Value="14" />
      <Setter Property="FontWeight" Value="SemiBold" />
      <Setter Property="CornerRadius" Value="6" />
      <Setter Property="Cursor" Value="Hand" />
    </Style>
  </Window.Resources>

  <Border Background="White" CornerRadius="12" BorderThickness="1" BorderBrush="#E0E0E0">
    <Border.Effect>
      <DropShadowEffect Color="Black" Opacity="0.15" BlurRadius="20" ShadowDepth="0" />
    </Border.Effect>

    <Grid>
      <!-- Custom Title Bar -->
      <Border
        Height="50"
        VerticalAlignment="Top"
        Background="#0078D7"
        CornerRadius="12,12,0,0"
        MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"
      >
        <Grid>
          <TextBlock
            Text="Password Recovery"
            FontSize="16"
            FontWeight="SemiBold"
            Foreground="White"
            VerticalAlignment="Center"
            Margin="25,0,0,0"
          />

          <telerik:RadButton
            Content="✕"
            Width="45"
            Height="50"
            HorizontalAlignment="Right"
            Background="Transparent"
            Foreground="White"
            FontSize="18"
            BorderThickness="0"
            Click="CloseButton_Click"
            Cursor="Hand"
          >
            <telerik:RadButton.Style>
              <Style TargetType="telerik:RadButton">
                <Setter Property="Background" Value="Transparent" />
                <Style.Triggers>
                  <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E81123" />
                  </Trigger>
                </Style.Triggers>
              </Style>
            </telerik:RadButton.Style>
          </telerik:RadButton>
        </Grid>
      </Border>

      <!-- Main Content -->
      <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,50,0,0">
        <Grid Margin="60,40,60,40">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
          </Grid.RowDefinitions>

          <!-- Header Section -->
          <StackPanel Grid.Row="0" Margin="0,0,0,35">
            <Viewbox Width="70" Height="70" Margin="0,0,0,20">
              <Canvas Width="100" Height="100">
                <Ellipse Width="100" Height="100" Fill="#0078D7" Opacity="0.1" />
                <Path Data="M50,25 L50,45" Stroke="#0078D7" StrokeThickness="6" />
                <Path Data="M40,50 Q50,60 60,50" Stroke="#0078D7" StrokeThickness="6" />
                <Ellipse
                  Width="80"
                  Height="50"
                  Canvas.Left="10"
                  Canvas.Top="55"
                  Stroke="#0078D7"
                  StrokeThickness="6"
                  Fill="Transparent"
                />
              </Canvas>
            </Viewbox>

            <TextBlock
              Text="Forgot Your Password?"
              FontSize="28"
              FontWeight="Bold"
              Foreground="#212121"
              HorizontalAlignment="Center"
              Margin="0,0,0,8"
            />

            <TextBlock
              Text="Enter your details below to reset your password"
              FontSize="14"
              Foreground="#757575"
              HorizontalAlignment="Center"
              Opacity="0.7"
            />
          </StackPanel>

          <!-- Form Section -->
          <StackPanel Grid.Row="1">
            <!-- Verification Section -->
            <Border
              Background="#FAFAFA"
              Padding="25"
              CornerRadius="8"
              BorderThickness="1"
              BorderBrush="#E0E0E0"
              Margin="0,0,0,20"
            >
              <StackPanel>
                <TextBlock
                  Text="STEP 1: VERIFY YOUR IDENTITY"
                  FontSize="12"
                  FontWeight="Bold"
                  Foreground="#0078D7"
                  Margin="0,0,0,20"
                />

                <!-- Username -->
                <TextBlock Text="Username" Style="{StaticResource SectionHeaderStyle}" />
                <telerik:RadWatermarkTextBox
                  WatermarkContent="Enter your username"
                  Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"
                  Height="40"
                  FontSize="14"
                  Margin="0,0,0,18"
                />

                <!-- Security Question -->
                <TextBlock Text="Security Question" Style="{StaticResource SectionHeaderStyle}" />
                <telerik:RadComboBox
                  ItemsSource="{Binding SecurityQuestions}"
                  SelectedItem="{Binding SelectedSecurityQuestion}"
                  Height="40"
                  FontSize="14"
                  Margin="0,0,0,18"
                />

                <!-- Security Answer -->
                <TextBlock Text="Answer" Style="{StaticResource SectionHeaderStyle}" />
                <telerik:RadWatermarkTextBox
                  WatermarkContent="Enter your security answer"
                  Text="{Binding SecurityAnswer, UpdateSourceTrigger=PropertyChanged}"
                  Height="40"
                  FontSize="14"
                  Margin="0,0,0,20"
                />

                <!-- Verify Button -->
                <telerik:RadButton
                  Content="VERIFY IDENTITY"
                  Command="{Binding VerifyCommand}"
                  Style="{StaticResource PrimaryButtonStyle}"
                  Background="#0078D7"
                  Foreground="White"
                  HorizontalAlignment="Center"
                  Width="200"
                />
              </StackPanel>
            </Border>

            <!-- Status Message -->
            <Border Background="DarkSeaGreen" Padding="15" CornerRadius="6" Margin="0,0,0,20">
              <Border.Style>
                <Style TargetType="Border">
                  <Setter Property="Visibility" Value="Visible" />
                  <Style.Triggers>
                    <DataTrigger Binding="{Binding StatusMessage}" Value="{x:Null}">
                      <Setter Property="Visibility" Value="Collapsed" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding StatusMessage}" Value="">
                      <Setter Property="Visibility" Value="Collapsed" />
                    </DataTrigger>
                  </Style.Triggers>
                </Style>
              </Border.Style>
              <StackPanel Orientation="Horizontal">
                <TextBlock
                  Text="⚠"
                  FontSize="16"
                  Foreground="White"
                  Margin="0,0,10,0"
                  VerticalAlignment="Center"
                />
                <TextBlock
                  Text="{Binding StatusMessage}"
                  Foreground="White"
                  FontSize="13"
                  FontWeight="SemiBold"
                  TextWrapping="Wrap"
                  VerticalAlignment="Center"
                />
              </StackPanel>
            </Border>

            <!-- Reset Password Section -->
            <Border
              Background="#FAFAFA"
              Padding="25"
              CornerRadius="8"
              BorderThickness="1"
              BorderBrush="#E0E0E0"
              IsEnabled="{Binding CanReset}"
            >
              <Border.Style>
                <Style TargetType="Border">
                  <Setter Property="Opacity" Value="1" />
                  <Style.Triggers>
                    <Trigger Property="IsEnabled" Value="False">
                      <Setter Property="Opacity" Value="0.5" />
                    </Trigger>
                  </Style.Triggers>
                </Style>
              </Border.Style>

              <StackPanel>
                <TextBlock
                  Text="STEP 2: SET NEW PASSWORD"
                  FontSize="12"
                  FontWeight="Bold"
                  Foreground="#0078D7"
                  Margin="0,0,0,20"
                />

                <!-- New Password -->
                <TextBlock Text="New Password" Style="{StaticResource SectionHeaderStyle}" />
                <PasswordBox
                  x:Name="NewPwdBox"
                  PasswordChanged="NewPwdBox_OnPasswordChanged"
                  Height="40"
                  FontSize="14"
                  Margin="0,0,0,18"
                />

                <!-- Confirm Password -->
                <TextBlock Text="Confirm Password" Style="{StaticResource SectionHeaderStyle}" />
                <PasswordBox
                  x:Name="ConfirmPwdBox"
                  PasswordChanged="ConfirmPwdBox_OnPasswordChanged"
                  Height="40"
                  FontSize="14"
                  Margin="0,0,0,25"
                />

                <!-- Reset Button -->
                <telerik:RadButton
                  Content="RESET PASSWORD"
                  Command="{Binding ResetPasswordCommand}"
                  Style="{StaticResource PrimaryButtonStyle}"
                  Background="#28A745"
                  Foreground="White"
                  HorizontalAlignment="Center"
                  Width="200"
                />
              </StackPanel>
            </Border>

            <!-- Back to Login -->
            <telerik:RadButton
              Content="← Back to Login"
              Command="{Binding BackToLoginCommand}"
              Height="36"
              Background="Transparent"
              BorderThickness="0"
              Foreground="#0078D7"
              FontSize="13"
              HorizontalAlignment="Center"
              Margin="0,20,0,0"
              Cursor="Hand"
            />
          </StackPanel>
        </Grid>
      </ScrollViewer>
    </Grid>
  </Border>
</Window>
<!--<Window x:Class="CaseManagementSystem.Views.Authentication.ForgotPasswordView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:CaseManagementSystem.ViewModels"
             xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
             Background="#F4F4F6"
        Title="Forgot Password" Height="500" Width="700" WindowStartupLocation="CenterScreen">

    <Window.DataContext>
        <vm:ForgotPasswordViewModel />
    </Window.DataContext>

    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <Border Margin="60" Padding="40" Background="White" CornerRadius="12"
                    BorderBrush="#D0D0D0" BorderThickness="1">
                <StackPanel>

                    <TextBlock Text="Forgot Password"
                               FontSize="30"
                               FontWeight="Bold"
                               Foreground="#2D2D2D"
                               HorizontalAlignment="Center"
                               Margin="0 0 0 25"/>

               
                    <TextBlock Text="Username *"/>
                    <telerik:RadWatermarkTextBox Label="Enter your username"
                                                 Text="{Binding Username}" Height="30" Margin="0,0,0,10"/>

        
                    <TextBlock Text="Security Question *"/>
                    <ComboBox ItemsSource="{Binding SecurityQuestions}" 
                              SelectedItem="{Binding SelectedSecurityQuestion}"
                              Height="30" Margin="0,0,0,10"/>

               
                    <TextBlock Text="Answer *"/>
                    <telerik:RadWatermarkTextBox Label="Enter answer"
                                                 Text="{Binding SecurityAnswer}" Height="30" Margin="0,0,0,15"/>

                
                    <telerik:RadButton Content="Verify" Command="{Binding VerifyCommand}"
                                       Height="40" Width="150" HorizontalAlignment="Center"
                                       Background="#0078D7" Foreground="White" FontWeight="SemiBold"/>

                    <TextBlock Text="{Binding StatusMessage}" Foreground="Red"
                               FontWeight="Bold" Margin="0,10,0,10" TextWrapping="Wrap"/>

               
                    <StackPanel Margin="0,15,0,0" IsEnabled="{Binding CanReset}">
                        <TextBlock Text="New Password *"/>
                        <PasswordBox x:Name="NewPwdBox" PasswordChanged="NewPwdBox_OnPasswordChanged" Height="30" Margin="0,0,0,10"/>

                        <TextBlock Text="Confirm Password *"/>
                        <PasswordBox x:Name="ConfirmPwdBox" PasswordChanged="ConfirmPwdBox_OnPasswordChanged" Height="30" Margin="0,0,0,15"/>

                        <telerik:RadButton Content="Reset Password" Command="{Binding ResetPasswordCommand}"
                                           Height="40" Width="180" HorizontalAlignment="Center"
                                           Background="#28A745" Foreground="White" FontWeight="SemiBold"/>
                    </StackPanel>

                </StackPanel>
            </Border>
        </ScrollViewer>
    </Grid>
</Window>-->
